"use strict";var restaurants,neighborhoods,cuisines,newMap,markers=[];document.addEventListener("DOMContentLoaded",function(e){initMap(),fetchNeighborhoods(),fetchCuisines()});var fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(e,t){e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,t=document.getElementById("neighborhoods-select");e.forEach(function(e){var n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})},fetchCuisines=function(){DBHelper.fetchCuisines(function(e,t){e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})},fillCuisinesHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.cuisines,t=document.getElementById("cuisines-select");e.forEach(function(e){var n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})},initMap=function(){self.newMap=L.map("map",{center:[40.722216,-73.987501],zoom:12,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoidGhlZ3JlYXRkZWJhdGUiLCJhIjoiY2pqeHhjY2V4YWh4ZDNxbGZtMXAxdndmdSJ9.buoZhVfjmQ4MLiAk0B4vaA",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),updateRestaurants()},updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,a=t.selectedIndex,o=e[n].value,r=t[a].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(o,r,function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})},resetRestaurants=function(e){self.restaurants=[];var t=document.getElementById("restaurants-list");t.innerHTML="",self.markers&&self.markers.forEach(function(e){return e.remove()}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))}),addMarkersToMap()},createRestaurantHTML=function(e){var t=document.createElement("li"),n=document.createElement("img");n.className="restaurant-img";var a=DBHelper.imageUrlForRestaurant(e),o=a.split("."),r=o[0]+"-800_2x."+o[1],s=o[0]+"-400_1x."+o[1];n.src=s,n.srcset="".concat(r," 2x, ").concat(s," 1x"),n.alt=e.name,t.append(n);var i=document.createElement("h3");i.innerHTML=e.name,t.append(i);var c=document.createElement("div"),l=!(!e.is_favorite||"true"!==e.is_favorite.toString());c.className="fav-icon";var u=document.createElement("button");u.style.background=l?'url("/img/like.svg") no-repeat':'url("/img/not-like.svg") no-repeat',u.id="fav-icon-".concat(e.id),u.onclick=function(t){return handleFavClick(e.id,!l)},c.append(u),t.append(c);var d=document.createElement("p");d.innerHTML=e.neighborhood,t.append(d);var m=document.createElement("p");m.innerHTML=e.address,t.append(m);var f=document.createElement("button");return f.innerHTML="Restaurant Details",f.onclick=function(){window.location.href=DBHelper.urlForRestaurant(e)},t.append(f),t},handleFavClick=function e(t,n){var a=document.getElementById("fav-icon-".concat(t));console.log("onclick info: ".concat(self.restaurants[t]));var o=self.restaurants[t-1];o.is_favorite=n,n?(a.setAttribute("aria-label","".concat(o.name," favorite")),a.style.background="url(/img/like.svg) no-repeat"):(a.setAttribute("aria-label","".concat(o.name," not favorite")),a.style.background="url(/img/not-like.svg) no-repeat"),a.onclick=function(a){return e(t,!n)}},addMarkersToMap=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurants;e.forEach(function(e){function t(){window.location.href=n.options.url}var n=DBHelper.mapMarkerForRestaurant(e,self.newMap);n.on("click",t),self.markers.push(n)})};
//# sourceMappingURL=main.js.map
