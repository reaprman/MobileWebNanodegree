"use strict";function modalToggle(){var e=document.getElementById("modal");e.classList.toggle("show-modal")}var restaurant,newMap;document.addEventListener("DOMContentLoaded",function(e){initMap()});var initMap=function(){fetchRestaurantFromURL(function(e,t){e?console.error(e):(self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoidGhlZ3JlYXRkZWJhdGUiLCJhIjoiY2pqeHhjY2V4YWh4ZDNxbGZtMXAxdndmdSJ9.buoZhVfjmQ4MLiAk0B4vaA",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap))})},fetchRestaurantFromURL=function(e){if(self.restaurant)return void e(null,self.restaurant);var t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,function(t,n){return self.restaurant=n,n?(fillRestaurantHTML(),void e(null,n)):void console.error(t)}):(error="No restaurant id in URL",e(error,null))},fillRestaurantHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("restaurant-name");t.innerHTML=e.name;var n=document.getElementById("restaurant-address");n.innerHTML=e.address;var a=document.getElementById("restaurant-img"),r=DBHelper.imageUrlForRestaurant(e),o=r.split("."),i=o[0]+"-400_1x."+o[1],l=o[0]+"-800_2x."+o[1],d=o[0]+"-1600."+o[1];a.className="restaurant-img",a.src=i,a.srcset="".concat(d," 1600w, ").concat(l," 800w, ").concat(i," 400w"),a.sizes="(max-width: 400px) 400px, (max-width: 800px) 800px, (max-width: 1200px) 1600px",a.alt=e.name;var c=document.getElementById("restaurant-cuisine");c.innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),DBHelper.fetchReviewByRestaurantId(e.id,function(e,t){fillReviewsHTML(e,t)}),fillReviewModal()},fillReviewModal=function(){var e=document.getElementById("rvw-rate"),t=[1,2,3,4,5];t.forEach(function(t){var n=document.createElement("option");n.value=t,n.innerText=t.toString(),e.append(n)});var n=document.getElementsByClassName("close-btn")[0];n.addEventListener("click",modalToggle),window.addEventListener("click",function(e){"modal"==e.target.id&&modalToggle()});var a=document.getElementsByClassName("submit-btn")[0];a.addEventListener("click",function(){var e=document.getElementsByClassName("rvw-reviewer")[0].value,t=document.getElementsByClassName("rvw-rate")[0].value,n=document.getElementsByClassName("rvw-comment")[0].value;DBHelper.saveReview(self.restaurant.id,e,t,n,function(e,t){e&&console.log("Error saving review: ".concat(e)),window.location.href="/restaurant.html?id=".concat(self.restaurant.id)})})},fillRestaurantHoursHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var n in e){var a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=n,a.appendChild(r);var o=document.createElement("td");o.innerHTML=e[n],a.appendChild(o),t.appendChild(a)}},fillReviewsHTML=function(e,t){e&&console.log("Error displaying reviews: ".concat(e)),self.restaurant.reviews=t;var n=document.getElementById("reviews-container"),a=document.createElement("h2");a.innerHTML="Reviews";var r=document.createElement("a");if(r.innerHTML="Add Review",r.onclick=modalToggle,a.appendChild(r),n.appendChild(a),!t){var o=document.createElement("p");return o.innerHTML="No reviews yet!",void n.appendChild(o)}var i=document.getElementById("reviews-list");t.forEach(function(e){i.appendChild(createReviewHTML(e))}),n.appendChild(i)},createReviewHTML=function(e){var t=document.createElement("li"),n=document.createElement("p");n.innerHTML=e.name,t.appendChild(n);var a=document.createElement("p");a.innerHTML=new Date(e.createdAt).toDateString(),t.appendChild(a);var r=document.createElement("p");r.innerHTML="Rating: ".concat(e.rating),t.appendChild(r);var o=document.createElement("p");return e.comments?o.innerHTML=e.comments:o.innerHTML=e.comment,t.appendChild(o),t},fillBreadcrumb=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]".concat(e,"(=([^&#]*)|&|#|$)")),a=n.exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null};
//# sourceMappingURL=restaurant_info.js.map
